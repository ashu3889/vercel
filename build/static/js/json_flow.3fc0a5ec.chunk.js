"use strict";(self.webpackChunkscrip_scanner=self.webpackChunkscrip_scanner||[]).push([[436],{824:(e,t,i)=>{i.d(t,{D:()=>s});class n{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:l(this,this._t0,o(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){let i=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,l(this,o(this,i=r(this,e,t)),i);break;default:l(this,this._t0,i=r(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function s(e){return function(t){return new n(t,e)}}function a(e){return e<0?-1:1}function r(e,t,i){let n=e._x1-e._x0,s=t-e._x1,r=(e._y1-e._y0)/(n||s<0&&-0),o=(i-e._y1)/(s||n<0&&-0),l=(r*s+o*n)/(n+s);return(a(r)+a(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(l))||0}function o(e,t){let i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function l(e,t,i){let n=e._x0,s=e._y0,a=e._x1,r=e._y1,o=(a-n)/1.5*(1-e._tension);e._context.bezierCurveTo(n+o,s+o*t,a-o,r-o*i,a,r)}},8657:(e,t,i)=>{i.d(t,{w:()=>s});class n{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:l(this,this._t0,o(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){[e,t]=[t,e];let i=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,l(this,o(this,i=r(this,e,t)),i);break;default:l(this,this._t0,i=r(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function s(e){function t(t){return new n(t,e)}return t.tension=function(e){return s(+e)},t}function a(e){return e<0?-1:1}function r(e,t,i){let n=e._x1-e._x0,s=t-e._x1,r=(e._y1-e._y0)/(n||s<0&&-0),o=(i-e._y1)/(s||n<0&&-0),l=(r*s+o*n)/(n+s);return(a(r)+a(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(l))||0}function o(e,t){let i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function l(e,t,i){let n=e._x0,s=e._y0,a=e._x1,r=e._y1,o=(a-n)/1.5*(1-e._tension);e._context.bezierCurveTo(s+o*t,n+o,r-o*i,a-o,r,a)}},4430:(e,t,i)=>{i.d(t,{i:()=>l});var n=i(1120),s=i(9867),a=i(9409),r=i(711),o=i(5788);class l extends s.J{constructor(){super(...arguments),Object.defineProperty(this,"_flipped",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._textKeys.push("textType","kerning"),super._afterNew()}_makeText(){this._text=this.children.push(a.R.new(this._root,{}))}baseRadius(){const e=this.getPrivate("radius",0),t=this.getPrivate("innerRadius",0),i=this.get("baseRadius",0);return t+o.JY(i,e-t)}radius(){const e=this.get("inside",!1);return this.baseRadius()+this.get("radius",0)*(e?-1:1)}_updateChildren(){if(super._updateChildren(),this.isDirty("baseRadius")||this.isPrivateDirty("radius")||this.isPrivateDirty("innerRadius")||this.isDirty("labelAngle")||this.isDirty("radius")||this.isDirty("inside")||this.isDirty("orientation")||this.isDirty("textType")){const e=this.get("textType","adjusted"),t=this.get("inside",!1),i=this.get("orientation");let s=r.n0(this.get("labelAngle",0));this._text.set("startAngle",this.get("labelAngle",0)),this._text.set("inside",t);const a=r.F8(s),o=r.gn(s);let l=this.baseRadius(),c=this.radius();if(this._display.angle=0,"circular"==e)this.setAll({paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}),this.setRaw("x",void 0),this.setRaw("y",void 0),this._text.set("orientation",i),this._text.set("radius",c);else{0==l&&(s=0,c=0);let t=c*o,r=c*a;"radial"==e?(this.setRaw("x",t),this.setRaw("y",r),s<90||s>270||"auto"!=i?(this._display.angle=s,this._flipped=!1):(this._display.angle=s+180,this._flipped=!0),this._dirty.rotation=!1):"adjusted"==e?(this.setRaw("centerX",n.yP),this.setRaw("centerY",n.yP),this.setRaw("x",t),this.setRaw("y",r)):"regular"==e&&(this.setRaw("x",t),this.setRaw("y",r))}this.markDirtyPosition(),this.markDirtyBounds()}}_updatePosition(){const e=this.get("textType","regular"),t=this.get("inside",!1);let i=0,s=0,a=this.get("labelAngle",0),o=this.localBounds(),l=o.right-o.left,c=o.bottom-o.top;if("radial"==e){if(this._flipped){let e=this.get("centerX");e instanceof n.QE&&(l*=1-2*e.value),i=l*r.gn(a),s=l*r.F8(a)}}else t||"adjusted"!=e||(i=l/2*r.gn(a),s=c/2*r.F8(a));this.setRaw("dx",i),this.setRaw("dy",s),super._updatePosition()}get text(){return this._text}}Object.defineProperty(l,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialLabel"}),Object.defineProperty(l,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:s.J.classNames.concat([l.className])})},9409:(e,t,i)=>{i.d(t,{R:()=>a});var n=i(9638),s=i(711);class a extends n.E{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeRadialText("",this.textStyle)})}_afterNew(){super._afterNew()}_beforeChanged(){super._beforeChanged(),this._display.clear(),this.isDirty("textType")&&(this._display.textType=this.get("textType"),this.markDirtyBounds()),this.isDirty("radius")&&(this._display.radius=this.get("radius"),this.markDirtyBounds()),this.isDirty("startAngle")&&(this._display.startAngle=(this.get("startAngle",0)+90)*s.nr,this.markDirtyBounds()),this.isDirty("inside")&&(this._display.inside=this.get("inside"),this.markDirtyBounds()),this.isDirty("orientation")&&(this._display.orientation=this.get("orientation"),this.markDirtyBounds()),this.isDirty("kerning")&&(this._display.kerning=this.get("kerning"),this.markDirtyBounds())}}Object.defineProperty(a,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialText"}),Object.defineProperty(a,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.E.classNames.concat([a.className])})},6299:(e,t,i)=>{i.d(t,{J:()=>l});var n=i(6648),s=i(5077),a=i(1120),r=i(9927),o=i(711);class l extends n.A{constructor(){super(...arguments),Object.defineProperty(this,"ix",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"iy",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_generator",{enumerable:!0,configurable:!0,writable:!0,value:(0,r.A)()})}_getTooltipPoint(){let e=this.get("tooltipX"),t=this.get("tooltipY"),i=0,n=0;s.Et(e)&&(i=e),s.Et(t)&&(n=t);let r=this.get("radius",0),o=this.get("innerRadius",0);return r+=this.get("dRadius",0),o+=this.get("dInnerRadius",0),o<0&&(o=r+o),e instanceof a.QE&&(i=this.ix*(o+(r-o)*e.value)),t instanceof a.QE&&(n=this.iy*(o+(r-o)*t.value)),this.get("arc")>=360&&0==o&&(i=0,n=0),{x:i,y:n}}_beforeChanged(){super._beforeChanged(),(this.isDirty("radius")||this.isDirty("arc")||this.isDirty("innerRadius")||this.isDirty("startAngle")||this.isDirty("dRadius")||this.isDirty("dInnerRadius")||this.isDirty("cornerRadius")||this.isDirty("shiftRadius"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){let e=this.get("startAngle",0),t=this.get("arc",0);const i=this._generator;t<0&&(e+=t,t*=-1),t>.1&&i.cornerRadius(this.get("cornerRadius",0)),i.context(this._display);let n=this.get("radius",0),s=this.get("innerRadius",0);n+=this.get("dRadius",0),s+=this.get("dInnerRadius",0),s<0&&(s=n+s),i({innerRadius:s,outerRadius:n,startAngle:(e+90)*o.nr,endAngle:(e+t+90)*o.nr});let a=e+t/2;this.ix=o.gn(a),this.iy=o.F8(a);const r=this.get("shiftRadius",0);this.setRaw("dx",this.ix*r),this.setRaw("dy",this.iy*r),this.markDirtyPosition()}}}Object.defineProperty(l,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Slice"}),Object.defineProperty(l,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.A.classNames.concat([l.className])})},1011:(e,t,i)=>{i.d(t,{H:()=>s});var n=i(2857);class s extends n.wC{_afterNew(){super._afterNewApplyThemes()}getFill(e){return{addColorStop:(e,t)=>{}}}_changed(){super._changed()}getBounds(e){const t=this.get("target");if(t){let i=t.globalBounds();const n=e.toLocal({x:i.left,y:i.top}),s=e.toLocal({x:i.right,y:i.top}),a=e.toLocal({x:i.right,y:i.bottom}),r=e.toLocal({x:i.left,y:i.bottom});return{left:Math.min(n.x,s.x,a.x,r.x),top:Math.min(n.y,s.y,a.y,r.y),right:Math.max(n.x,s.x,a.x,r.x),bottom:Math.max(n.y,s.y,a.y,r.y)}}return e._display.getLocalBounds()}}Object.defineProperty(s,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Gradient"}),Object.defineProperty(s,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.wC.classNames.concat([s.className])})},3598:(e,t,i)=>{i.d(t,{W:()=>l});var n=i(1011),s=i(1046),a=i(7552),r=i(5077),o=i(711);class l extends n.H{getFill(e){const t=this.get("rotation",0);let i=this.getBounds(e),n=i.left||0,l=i.right||0,c=i.top||0,u=i.bottom||0,h=o.gn(t),d=o.F8(t),g=h*(l-n),f=d*(u-c);0==g&&(g=1),0==f&&(f=1);let p=Math.max(g,f);const b=this._root._renderer.createLinearGradient(n,c,n+p*h,c+p*d),y=this.get("stops");if(y){let e=0;a.__(y,(t=>{let i=t.offset;r.Et(i)||(i=e/(y.length-1));let n=t.opacity;r.Et(n)||(n=1);let a=t.color;if(a){const e=t.lighten;e&&(a=s.Q1.lighten(a,e));const r=t.brighten;r&&(a=s.Q1.brighten(a,r)),b.addColorStop(i,"rgba("+a.r+","+a.g+","+a.b+","+n+")")}e++}))}return b}}Object.defineProperty(l,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LinearGradient"}),Object.defineProperty(l,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:n.H.classNames.concat([l.className])})},4625:(e,t,i)=>{i.d(t,{ArcDiagram:()=>We,ArcDiagramLink:()=>Ee,ArcDiagramNodes:()=>Be,Chord:()=>oe,ChordDirected:()=>ce,ChordLink:()=>ae,ChordLinkDirected:()=>le,ChordNodes:()=>ie,ChordNonRibbon:()=>ue,Flow:()=>p,FlowLink:()=>se,FlowNode:()=>U,FlowNodes:()=>Z,Sankey:()=>Fe,SankeyLink:()=>ge,SankeyNodes:()=>de});var n=i(6326),s=i(1685),a=i(1120),r=i(9328),o=i(1539),l=i(7552),c=i(5799);class u extends s.S{setupDefaultRules(){super.setupDefaultRules();const e=this._root.interfaceColors,t=this.rule.bind(this);t("Flow").setAll({width:a.Q2,height:a.Q2,paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,hiddenSize:.05,minSize:0,minHiddenValue:0}),t("FlowNodes").setAll({colors:r.e.new(this._root,{}),legendLabelText:"{name}",legendValueText:"{sumOutgoing.formatNumber('#.#')}"}),t("FlowNode").setAll({setStateOnChildren:!0,cursorOverStyle:"pointer",toggleKey:"disabled"}),t("FlowNode").states.create("disabled",{}),t("FlowNode",["unknown"]).setAll({draggable:!1,opacity:0}),t("Label",["flow"]).states.create("disabled",{fill:e.get("disabled")}),t("RadialLabel",["flow","node"]).setAll({text:"{name}",populateText:!0}),t("FlowLink").setAll({fillStyle:"gradient",strokeStyle:"gradient"}),t("FlowLink",["source","unknown"]).setAll({}),t("FlowLink",["target","unknown"]).setAll({}),t("FlowNode").events.on("pointerover",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.__(e,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}));const i=t.get("incomingLinks");i&&l.__(i,(e=>{const t=e.get("link");t.hover(),t.hideTooltip()}))}let i=t.get("slice")||t.get("rectangle");i&&i.get("tooltipText")&&i.showTooltip()})),t("FlowNode").events.on("pointerout",(e=>{const t=e.target.dataItem;if(t){const e=t.get("outgoingLinks");e&&l.__(e,(e=>{e.get("link").unhover()}));const i=t.get("incomingLinks");i&&l.__(i,(e=>{e.get("link").unhover()}))}})),t("Sankey").setAll({orientation:"horizontal",nodeAlign:"justify",linkTension:.5,nodePadding:10,nodeWidth:10}),t("RoundedRectangle",["sankey","node","shape"]).setAll({cornerRadiusTL:0,cornerRadiusBL:0,cornerRadiusTR:0,cornerRadiusBR:0}),t("RoundedRectangle",["shape"]).states.create("disabled",{fill:e.get("disabled")}),t("SankeyLink").setAll({controlPointDistance:.2}),t("FlowNode",["sankey"]).setAll({draggable:!0});{const i=t("Graphics",["sankey","link"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0,tooltipText:"{sourceId} - {targetId}: {value}"}),(0,o.w)(i,"fill",e,"grid")}t("Graphics",["sankey","link"]).states.create("hover",{fillOpacity:.5}),t("Label",["sankey","node"]).setAll({text:"{name}",populateText:!0}),t("Label",["sankey","horizontal"]).setAll({y:a.yP,centerY:a.yP,paddingLeft:15}),t("Label",["sankey","vertical"]).setAll({x:a.yP,centerX:a.yP,paddingTop:15}),t("Chord").setAll({radius:(0,a.KN)(90),nodeWidth:10,padAngle:1,startAngle:0,sort:"none"}),t("ChordDirected").setAll({linkHeadRadius:10}),t("ChordNodes").setAll({x:a.yP,y:a.yP}),t("FlowNode",["chord"]).setAll({draggable:!0}),t("ChordLink").setAll({sourceRadius:a.Q2,targetRadius:a.Q2,fillStyle:"solid",strokeStyle:"solid",tooltipText:"{sourceId} - {targetId}: {value}"}),t("Slice",["chord","node","shape"]).setAll({cornerRadius:0}),t("Slice",["shape"]).states.create("disabled",{fill:e.get("disabled")}),t("RadialLabel",["chord","node"]).setAll({radius:5,textType:"circular"}),t("ChordLinkDirected").setAll({headRadius:10});{const i=t("Graphics",["chord","link","shape"]);i.setAll({fillOpacity:.2,strokeOpacity:0,interactive:!0}),(0,o.w)(i,"fill",e,"grid"),(0,o.w)(i,"stroke",e,"grid")}t("Graphics",["chord","link","shape"]).states.create("hover",{fillOpacity:.5}),t("ChordNonRibbon").setAll({linkType:"curve"}),t("ChordLink",["basic"]).setAll({fillStyle:"none",strokeStyle:"source"}),t("Graphics",["chord","link","shape","basic"]).setAll({strokeOpacity:.4}),t("Graphics",["chord","link","shape","basic"]).states.create("hover",{strokeWidth:2,strokeOpacity:1}),t("ArcDiagram").setAll({orientation:"horizontal",nodePadding:5,minRadius:5,radiusKey:"sum",animationEasing:c.FD(c.tA)}),t("ArcDiagramNodes",["horizontal"]).setAll({y:a.Q2,centerY:a.Q2}),t("ArcDiagramNodes",["vertical"]).setAll({centerX:0}),t("Circle",["arcdiagram","node","shape"]).setAll({tooltipText:"{name}: {sum}"}),t("Circle",["arcdiagram","node","shape"]).states.create("disabled",{fill:e.get("disabled")});{const i=t("ArcDiagramLink",["link","shape"]);i.setAll({strokeOpacity:.15,strokeStyle:"solid",fillStyle:"none",isMeasured:!1}),(0,o.w)(i,"stroke",e,"grid")}t("ArcDiagramLink",["link","shape"]).states.create("hover",{strokeOpacity:1}),t("Label",["arcdiagram","node"]).setAll({text:"{name}",populateText:!0}),t("Label",["arcdiagram","horizontal"]).setAll({y:0,centerY:a.yP,centerX:a.Q2,rotation:-90}),t("Label",["arcdiagram","vertical"]).setAll({centerY:a.yP,centerX:a.Q2,paddingRight:15})}}var h=i(1316),d=i(7294),g=i(3598),f=i(5077);class p extends h.s{constructor(){super(...arguments),Object.defineProperty(this,"linksContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(d.m.new(this._root,{}))}),Object.defineProperty(this,"_nodesData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_linksData",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_index",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_nodesDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_linksByIndex",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._defaultThemes.push(u.new(this._root)),this.fields.push("disabled","sourceId","targetId"),this.nodes&&(this.nodes.flow=this),super._afterNew(),this.children.push(this.bulletsContainer)}processDataItem(e){super.processDataItem(e);const t=this.nodes;if(t){let i=!1,n=e.get("sourceId"),s=t.getDataItemById(n);s||(null==n&&(n="undefined"+this._index,this._index++,i=!0),t.data.push({id:n,unknown:i}),s=t.getDataItemById(n),i||s.set("name",n)),i=!1;let a=e.get("targetId"),r=t.getDataItemById(a);r||(null==a&&(a="undefined"+this._index,this._index++,i=!0),t.data.push({id:a,unknown:i}),r=t.getDataItemById(a),i||r.set("name",a)),s&&(e.set("source",s),t.addOutgoingLink(s,e)),r&&(e.set("target",r),t.addincomingLink(r,e)),e.set("link",this.makeLink(e));const o=this.nodes.dataItems.indexOf(s),l=this.nodes.dataItems.indexOf(r);this._linksByIndex[o+"_"+l]=e,s.get("unknown")&&(r&&s.set("fill",r.get("fill")),e.get("link").set("fillStyle","gradient")),r.get("unknown")&&(s&&r.set("fill",s.get("fill")),e.get("link").set("fillStyle","gradient")),this._updateLinkColor(e)}}_onDataClear(){this.nodes._userDataSet||(this.nodes.data.setAll([]),this.nodes._userDataSet=!1)}_prepareChildren(){super._prepareChildren();let e=1/0,t=-1/0,i=0;if(this._valuesDirty){this._nodesData=[];const n=this.nodes;n&&l.__(n.dataItems,(e=>{const t=e.get("d3SankeyNode");this._nodesData.push(t);const i=e.get("incomingLinks");let s=0,a=0;i&&l.__(i,(e=>{const t=e.get("value"),i=e.get("valueWorking");s+=t,a+=i})),e.set("sumIncoming",s),e.set("sumIncomingWorking",a);const r=e.get("outgoingLinks");let o=0,c=0;r&&l.__(r,(e=>{const t=e.get("value"),i=e.get("valueWorking");o+=t,c+=i})),e.set("sumOutgoing",o),e.set("sumOutgoingWorking",c),e.set("sum",s+o),e.set("sumWorking",a+c),n.updateLegendValue(e)})),this._linksData=[],l.__(this.dataItems,(n=>{let s=n.get("value");f.Et(s)&&(s<e&&(e=s),s>t&&(t=s),i+=s)})),l.__(this.dataItems,(e=>{let t=e.get("value");if(f.Et(t)){let t=e.get("valueWorking"),n=this.get("minSize",0);n>0&&t<n*i&&(t=n*i);let s={source:e.get("source").get("d3SankeyNode"),target:e.get("target").get("d3SankeyNode"),value:t};e.setRaw("d3SankeyLink",s),this._linksData.push(s),this.updateLegendValue(e)}})),this.setPrivateRaw("valueHigh",t),this.setPrivateRaw("valueLow",e),this.setPrivateRaw("valueSum",i)}}_updateLinkColor(e){const t=e.get("link"),i=t.get("fillStyle"),n=t.get("strokeStyle"),s=e.get("source"),a=e.get("target"),r=s.get("fill"),o=a.get("fill");switch(t.remove("fillGradient"),t.remove("strokeGradient"),i){case"solid":t._applyTemplates();break;case"source":t.set("fill",r);break;case"target":t.set("fill",o);break;case"gradient":let e=t._fillGradient;e||(e=g.W.new(this._root,{}));const i={color:r};s.get("unknown")&&(i.opacity=0);const n={color:o};a.get("unknown")&&(n.opacity=0),e.set("stops",[i,n]),t._fillGradient=e,t.set("fillGradient",e);break;case"none":t.set("fill",void 0)}switch(n){case"solid":t._applyTemplates();break;case"source":t.set("stroke",r);break;case"target":t.set("stroke",o);break;case"gradient":let e=t._strokeGradient;if(!e){e=g.W.new(this._root,{});const i={color:r};s.get("unknown")&&(i.opacity=0);const n={color:o};a.get("unknown")&&(n.opacity=0),e.set("stops",[i,n]),t._strokeGradient=e}t.set("strokeGradient",e);break;case"none":t.remove("stroke")}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("link");t&&(this.links.removeValue(t),t.dispose())}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.states.create("hidden",{}),a="stateAnimationDuration",r="stateAnimationEasing";f.Et(t)||(t=s.get(a,this.get(a,0)));const o=s.get(r,this.get(r));n.push(e.animate({key:"valueWorking",to:Math.max(this.get("minHiddenValue",0),this.get("hiddenSize",0)*e.get("value")),duration:t,easing:o}).waitForStop());e.get("link").hide(),yield Promise.all(n)}))}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)];f.Et(t)||(t=this.get("stateAnimationDuration",0));const s=this.get("stateAnimationEasing");n.push(e.animate({key:"valueWorking",to:e.get("value"),duration:t,easing:s}).waitForStop());e.get("link").show(),yield Promise.all(n)}))}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=i.get("link"),n=e.get("sprite");if(n){const i=t.getPoint(this._getBulletLocation(e));n.setAll({x:i.x,y:i.y}),e.get("autoRotate")&&n.set("rotation",i.angle+e.get("autoRotateAngle",0))}}}}_getBulletLocation(e){return e.get("locationY",0)}}Object.defineProperty(p,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Flow"}),Object.defineProperty(p,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:h.s.classNames.concat([p.className])});var b=Math.abs,y=Math.cos,m=Math.sin,_=Math.PI,k=_/2,w=2*_,v=Math.max,x=1e-12;function P(e,t){return Array.from({length:t-e},((t,i)=>e+i))}function D(e,t){var i=0,n=null,s=null,a=null;function r(r){var o,l=r.length,c=new Array(l),u=P(0,l),h=new Array(l*l),d=new Array(l),g=0;r=Float64Array.from({length:l*l},t?(e,t)=>r[t%l][t/l|0]:(e,t)=>r[t/l|0][t%l]);for(let t=0;t<l;++t){let i=0;for(let n=0;n<l;++n)i+=r[t*l+n]+e*r[n*l+t];g+=c[t]=i}o=(g=v(0,w-i*l)/g)?i:w/l;{let t=0;n&&u.sort(((e,t)=>n(c[e],c[t])));for(const i of u){const n=t;if(e){const e=P(1+~l,l).filter((e=>e<0?r[~e*l+i]:r[i*l+e]));s&&e.sort(((e,t)=>s(e<0?-r[~e*l+i]:r[i*l+e],t<0?-r[~t*l+i]:r[i*l+t])));for(const n of e)if(n<0){(h[~n*l+i]||(h[~n*l+i]={source:null,target:null})).target={index:i,startAngle:t,endAngle:t+=r[~n*l+i]*g,value:r[~n*l+i]}}else{(h[i*l+n]||(h[i*l+n]={source:null,target:null})).source={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]}}d[i]={index:i,startAngle:n,endAngle:t,value:c[i]}}else{const e=P(0,l).filter((e=>r[i*l+e]||r[e*l+i]));s&&e.sort(((e,t)=>s(r[i*l+e],r[i*l+t])));for(const n of e){let e;if(i<n?(e=h[i*l+n]||(h[i*l+n]={source:null,target:null}),e.source={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]}):(e=h[n*l+i]||(h[n*l+i]={source:null,target:null}),e.target={index:i,startAngle:t,endAngle:t+=r[i*l+n]*g,value:r[i*l+n]},i===n&&(e.source=e.target)),e.source&&e.target&&e.source.value<e.target.value){const t=e.source;e.source=e.target,e.target=t}}d[i]={index:i,startAngle:n,endAngle:t,value:c[i]}}t+=o}}return(h=Object.values(h)).groups=d,a?h.sort(a):h}return r.padAngle=function(e){return arguments.length?(i=v(0,e),r):i},r.sortGroups=function(e){return arguments.length?(n=e,r):n},r.sortSubgroups=function(e){return arguments.length?(s=e,r):s},r.sortChords=function(e){return arguments.length?(null==e?a=null:(t=e,a=function(e,i){return t(e.source.value+e.target.value,i.source.value+i.target.value)})._=e,r):a&&a._;var t},r}var A=i(3718),N=Array.prototype.slice;function L(e){return function(){return e}}function j(e){return e.source}function O(e){return e.target}function I(e){return e.radius}function T(e){return e.startAngle}function R(e){return e.endAngle}function S(){return 0}function C(){return 10}function M(e){var t=j,i=O,n=I,s=I,a=T,r=R,o=S,l=null;function c(){var c,u=t.apply(this,arguments),h=i.apply(this,arguments),d=o.apply(this,arguments)/2,g=N.call(arguments),f=+n.apply(this,(g[0]=u,g)),p=a.apply(this,g)-k,_=r.apply(this,g)-k,w=+s.apply(this,(g[0]=h,g)),v=a.apply(this,g)-k,P=r.apply(this,g)-k;if(l||(l=c=(0,A.Ae)()),d>x&&(b(_-p)>2*d+x?_>p?(p+=d,_-=d):(p-=d,_+=d):p=_=(p+_)/2,b(P-v)>2*d+x?P>v?(v+=d,P-=d):(v-=d,P+=d):v=P=(v+P)/2),l.moveTo(f*y(p),f*m(p)),l.arc(0,0,f,p,_),p!==v||_!==P)if(e){var D=w-+e.apply(this,arguments),L=(v+P)/2;l.quadraticCurveTo(0,0,D*y(v),D*m(v)),l.lineTo(w*y(L),w*m(L)),l.lineTo(D*y(P),D*m(P))}else l.quadraticCurveTo(0,0,w*y(v),w*m(v)),l.arc(0,0,w,v,P);if(l.quadraticCurveTo(0,0,f*y(p),f*m(p)),l.closePath(),c)return l=null,c+""||null}return e&&(c.headRadius=function(t){return arguments.length?(e="function"===typeof t?t:L(+t),c):e}),c.radius=function(e){return arguments.length?(n=s="function"===typeof e?e:L(+e),c):n},c.sourceRadius=function(e){return arguments.length?(n="function"===typeof e?e:L(+e),c):n},c.targetRadius=function(e){return arguments.length?(s="function"===typeof e?e:L(+e),c):s},c.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:L(+e),c):a},c.endAngle=function(e){return arguments.length?(r="function"===typeof e?e:L(+e),c):r},c.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:L(+e),c):o},c.source=function(e){return arguments.length?(t=e,c):t},c.target=function(e){return arguments.length?(i=e,c):i},c.context=function(e){return arguments.length?(l=null==e?null:e,c):l},c}function F(){return M()}function G(){return M(C)}function B(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function E(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}i(4291);const{abs:W,max:H,min:z}=Math;function Y(e){return[+e[0],+e[1]]}function Q(e){return[Y(e[0]),Y(e[1])]}["w","e"].map(V),["n","s"].map(V),["n","w","e","s","nw","ne","sw","se"].map(V);function V(e){return{type:e}}function X(e,t,i){this.k=e,this.x=t,this.y=i}X.prototype={constructor:X,scale:function(e){return 1===e?this:new X(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new X(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new X(1,0,0);X.prototype;var J=i(4923),K=i(6873),q=i(9867);class U extends d.m{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}}Object.defineProperty(U,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNode"}),Object.defineProperty(U,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:d.m.classNames.concat([U.className])});class Z extends h.s{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>q.J._new(this._root,{themeTags:["flow"]},[this.labels.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>U._new(this._root,{themeTags:["node"]},[this.nodes.template])))}),Object.defineProperty(this,"_userDataSet",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this.fields.push("unknown","name","fill"),this.set("idField","id"),this.set("nameField","id"),this.set("fillField","fill"),this.set("unknownField","unknown"),this.children.push(this.bulletsContainer),super._afterNew()}_onDataClear(){const e=this.get("colors");e&&e.reset();const t=this.get("patterns");t&&t.reset(),this._userDataSet=!0}processDataItem(e){if(super.processDataItem(e),e.setRaw("d3SankeyNode",{name:e.get("id"),dataItem:e}),null==e.get("fill")){let t=this.get("colors");t&&e.setRaw("fill",t.next())}if(null==e.get("fillPattern")){let t=this.get("patterns");t&&e.setRaw("fillPattern",t.next())}const t=this.makeNode(e);e.setRaw("node",t);const i=this.get("disabledField");if(i){const t=e.dataContext;t&&t[i]&&this.root.events.once("frameended",(()=>{this.disableDataItem(e,0)}))}}makeNode(e,t){const i=this.nodes.make();return this.nodes.push(i),t&&i.addTag(t),e.get("unknown")&&i.addTag("unknown"),this.children.push(i),i._setDataItem(e),i.series=this,i.events.on("click",(e=>{const t=e.target;if("disabled"==t.get("toggleKey")){const e=t.dataItem;e&&(e.isHidden()?this.enableDataItem(e):this.disableDataItem(e))}})),e.on("fill",(()=>{this._updateNodeColor(e)})),e.on("fillPattern",(()=>{this._updateNodeColor(e)})),e.set("node",i),i}_updateNodeColor(e){}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("node");t&&(this.nodes.removeValue(t),t.dispose());let i=e.get("label");i&&(this.labels.removeValue(i),i.dispose())}addincomingLink(e,t){let i=e.get("incomingLinks");i||(i=[],e.set("incomingLinks",i)),i.push(t)}addOutgoingLink(e,t){let i=e.get("outgoingLinks");i||(i=[],e.set("outgoingLinks",i)),i.push(t)}showDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&i.show();let n=e.get("label");n&&n.show(t);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.showDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.showDataItem(e,t)}))}yield n}))}hideDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&i.hide();let n=e.get("label");n&&n.hide(t);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.hideDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.hideDataItem(e,t)}))}yield n}))}enableDataItem(e,t){const i=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.showDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&this.root.events.once("frameended",(()=>{i.set("disabled",!1)}));let n=e.get("label");n&&n.set("disabled",!1);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.showDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.showDataItem(e,t)}))}yield n}))}disableDataItem(e,t){const i=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return(0,n.sH)(this,void 0,void 0,(function*(){const n=[i.hideDataItem.call(this,e,t)],s=this.flow;if(s){const i=e.get("node");i&&this.root.events.once("frameended",(()=>{i.set("disabled",!0)}));let n=e.get("label");n&&n.set("disabled",!0);let a=e.get("outgoingLinks");a&&l.__(a,(e=>{s.hideDataItem(e,t)})),a=e.get("incomingLinks"),a&&l.__(a,(e=>{s.hideDataItem(e,t)}))}yield n}))}}Object.defineProperty(Z,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowNodes"}),Object.defineProperty(Z,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:h.s.classNames.concat([Z.className])});var $=i(6299),ee=i(4430),te=i(711);class ie extends Z{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>ee.i._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"slices",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>$.J._new(this._root,{themeTags:["shape"]},[this.slices.template])))}),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:this.slices})}makeNode(e){const t=super.makeNode(e,"chord"),i=t.children.insertIndex(0,this.slices.make());e.set("slice",i),i._setSoft("fill",e.get("fill")),i._setSoft("fillPattern",e.get("fillPattern"));const n=this.labels.make();return this.labels.push(n),n.addTag("flow"),n.addTag("chord"),n.addTag("node"),t.children.push(n),e.set("label",n),t.events.on("dragstart",(e=>{let t=this.toLocal(e.point);const i=te._H({x:0,y:0},t);this.flow&&(this._dAngle=this.flow.get("startAngle",0)-i)})),t.events.on("dragged",(e=>{let i=this.toLocal(e.point);const n=te._H({x:0,y:0},i);t.setAll({x:0,y:0}),this.flow&&this.flow.set("startAngle",n+this._dAngle)})),n._setDataItem(e),i._setDataItem(e),t}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=e.get("sprite");if(t){const n=i.get("slice"),s=e.get("locationX",.5),a=e.get("locationY",.5);if(n){const e=n.get("radius",0),i=n.get("innerRadius",0),r=i+(e-i)*a,o=n.get("startAngle",0)+n.get("arc",0)*s;t.setAll({x:r*te.gn(o),y:r*te.F8(o)})}}}}}_updateNodeColor(e){const t=e.get("slice");t&&(t.set("fill",e.get("fill")),t.set("fillPattern",e.get("fillPattern")))}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("slice");t&&(this.slices.removeValue(t),t.dispose())}}Object.defineProperty(ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNodes"}),Object.defineProperty(ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([ie.className])});var ne=i(6648);class se extends ne.A{constructor(){super(...arguments),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGradient",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_changed(){if(super._changed(),this.isDirty("fillStyle")){const e=this.series,t=this.dataItem;e&&t&&e._updateLinkColor(t)}}_getTooltipPoint(){let e=this.get("tooltipY"),t=.5;return e instanceof a.QE&&(t=e.value),this.getPoint(t)}}Object.defineProperty(se,"className",{enumerable:!0,configurable:!0,writable:!0,value:"FlowLink"}),Object.defineProperty(se,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ne.A.classNames.concat([se.className])});class ae extends se{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getPoint(e){if(this._p0&&this._p1){if("line"===this._type){let t=te.Md(this._p0,this._p1,e);return{x:t.x,y:t.y,angle:te._H(this._p0,this._p1)}}{let t=te.DW(this._p0,this._p1,{x:0,y:0},Math.max(0,e-.01)),i=te.DW(this._p0,this._p1,{x:0,y:0},Math.min(1,e+.01)),n=te.DW(this._p0,this._p1,{x:0,y:0},e);return{x:n.x,y:n.y,angle:te._H(t,i)}}}return{x:0,y:0,angle:0}}}Object.defineProperty(ae,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLink"}),Object.defineProperty(ae,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([ae.className])});var re=i(5788);class oe extends p{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>ae._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(ie.new(this._root,{}))}),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:D(!1,!1)}),Object.defineProperty(this,"_chordLayout",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_ribbon",{enumerable:!0,configurable:!0,writable:!0,value:F()})}_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["chord"]),this.linksContainer.setAll({x:a.yP,y:a.yP}),this.bulletsContainer.setAll({x:a.yP,y:a.yP}),super._afterNew()}_fixRibbon(e){e.startAngle((e=>e.startAngle+this.get("startAngle",0)*te.nr+Math.PI/2)),e.endAngle((e=>e.endAngle+this.get("startAngle",0)*te.nr+Math.PI/2))}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_makeMatrix(){const e=[];return l.__(this.nodes.dataItems,(t=>{const i=[];e.push(i);let n=t.get("outgoingLinks");l.__(this.nodes.dataItems,(e=>{let t=0;n&&l.__(n,(i=>{i.get("target")===e&&(t=i.get("valueWorking"));let n=this.getPrivate("valueSum",0),s=this.get("minSize",0);t>0&&s>0&&t<n*s&&(t=n*s)})),i.push(t)}))})),e}_prepareChildren(){super._prepareChildren(),this._fixRibbon(this._ribbon);let e=!1;if(this._valuesDirty||this._sizeDirty||this.isDirty("padAngle")||this.isDirty("startAngle")){const t=this._makeMatrix();this._d3chord.padAngle(this.get("padAngle",0)*te.nr);const i=this.get("sort");"ascending"===i?this._d3chord.sortGroups(B):"descending"===i&&this._d3chord.sortGroups(E),this._chordLayout=this._d3chord(t),e=!0}if(e||this.isDirty("radius")||this.isDirty("nodeWidth")){let e=re.JY(this.get("radius",0),Math.min(this.innerWidth(),this.innerHeight()))/2,t=0;const i=this.get("startAngle",0),n=this.get("nodeWidth",0);l.__(this.nodes.dataItems,(s=>{const a=s.get("slice"),r=this._chordLayout.groups[t],o=r.startAngle*te.iR+i,l=r.endAngle*te.iR+i;a.setAll({radius:e,innerRadius:e-n,startAngle:o,arc:l-o});const c=s.get("label");c.setAll({labelAngle:o+(l-o)/2}),c.setPrivate("radius",e),c.setPrivate("innerRadius",.1),t++}));const s=e-this.get("nodeWidth",0);l.__(this._chordLayout,(e=>{let t=this._linksByIndex[e.source.index+"_"+e.target.index];if(t||(t=this._linksByIndex[e.target.index+"_"+e.source.index]),t){const i=t.get("link");this._getLinkPoints(i,s,e),this._updateLink(this._ribbon,i,s,e)}}))}}_getLinkPoints(e,t,i){const n=i.source,s=i.target,a=this.get("startAngle",0)*te.nr;if(n&&s){const i=n.startAngle,r=i+(n.endAngle-i)/2+a,o=s.startAngle,l=o+(s.endAngle-o)/2+a;e._p0={x:t*Math.cos(r),y:t*Math.sin(r)},e._p1={x:t*Math.cos(l),y:t*Math.sin(l)}}}_updateLink(e,t,i,n){n&&(e.sourceRadius(re.JY(t.get("sourceRadius",a.Q2),i)),e.targetRadius(re.JY(t.get("targetRadius",a.Q2),i)),t.set("draw",(t=>{e.context(t),e(n)})))}}Object.defineProperty(oe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chord"}),Object.defineProperty(oe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:p.classNames.concat([oe.className])});class le extends ae{_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["chord","link","directed"]),super._afterNew()}}Object.defineProperty(le,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordLinkDirected"}),Object.defineProperty(le,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ae.classNames.concat([le.className])});class ce extends oe{constructor(){super(...arguments),Object.defineProperty(this,"_d3chord",{enumerable:!0,configurable:!0,writable:!0,value:D(!0,!1)}),Object.defineProperty(this,"_ribbonArrow",{enumerable:!0,configurable:!0,writable:!0,value:G()}),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>le._new(this._root,{themeTags:["link","shape"]},[this.links.template])))})}makeLink(e){const t=this.linksContainer.children.push(this.links.make());return t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["directed"]),super._afterNew(),this._markDirtyKey("linkHeadRadius")}_prepareChildren(){const e="linkHeadRadius";if(this.isDirty(e)){const t=this.get(e);if(null==t)this._ribbon=F();else{let e=G();e.headRadius(t),this._ribbon=e}}super._prepareChildren()}}Object.defineProperty(ce,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordDirected"}),Object.defineProperty(ce,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:oe.classNames.concat([ce.className])});class ue extends oe{_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["chord","basic"]),super._afterNew()}_makeMatrix(){const e=[];return l.__(this.nodes.dataItems,(t=>{const i=[];e.push(i),l.__(this.nodes.dataItems,(e=>{let n=1;t===e&&(n=0),i.push(n)}))})),e}_updateLink(e,t,i,n){if(t._type=this.get("linkType"),n){const e=this.get("linkType");t.set("draw",(i=>{let n=t._p0,s=t._p1;n&&s&&(i.moveTo(n.x,n.y),"line"==e?i.lineTo(s.x,s.y):i.quadraticCurveTo(0,0,s.x,s.y))}))}}_getLinkPoints(e,t,i){const n=e.get("source"),s=e.get("target");if(n&&s){const i=n.get("slice"),a=s.get("slice"),r=i.get("startAngle",0)+i.get("arc",0)/2,o=a.get("startAngle",0)+a.get("arc",0)/2;e._p0={x:t*te.gn(r),y:t*te.F8(r)},e._p1={x:t*te.gn(o),y:t*te.F8(o)}}}}Object.defineProperty(ue,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ChordNonRibbon"}),Object.defineProperty(ue,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:oe.classNames.concat([ue.className])});var he=i(3915);class de extends Z{constructor(){super(...arguments),Object.defineProperty(this,"rectangles",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>he.T._new(this._root,{themeTags:["shape"]},[this.rectangles.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}makeNode(e){const t=this.flow,i=super.makeNode(e,"sankey"),n=i.children.insertIndex(0,this.rectangles.make());this.rectangles.push(n),n._setSoft("fill",e.get("fill")),n._setSoft("fillPattern",e.get("fillPattern")),e.set("rectangle",n),i.events.on("dragged",(()=>{const e=i.dataItem.get("d3SankeyNode");e&&t&&("horizontal"==t.get("orientation")?(e.x0=i.x(),e.y0=i.y()):(e.x0=i.y(),e.y0=i.x()),t.updateSankey())}));const s=this.labels.make();return this.labels.push(s),t&&s.addTag(t.get("orientation","")),i.children.push(s),e.set("label",s),s._setDataItem(e),n._setDataItem(e),i}_positionBullet(e){const t=e.get("sprite");if(t){const i=t.dataItem;if(i){const t=e.get("sprite");if(t){const n=i.get("rectangle"),s=i.get("node"),a=e.get("locationX",.5),r=e.get("locationY",.5);n&&t.setAll({x:s.x()+n.width()*a,y:s.y()+n.height()*r})}}}}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("rectangle");t&&(this.rectangles.removeValue(t),t.dispose())}_updateNodeColor(e){const t=e.get("rectangle");t&&(t.set("fill",e.get("fill")),t.set("fillPattern",e.get("fillPattern")))}}Object.defineProperty(de,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyNodes"}),Object.defineProperty(de,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([de.className])});class ge extends se{constructor(){super(...arguments),Object.defineProperty(this,"_svgPath",{enumerable:!0,configurable:!0,writable:!0,value:document.createElementNS("http://www.w3.org/2000/svg","path")}),Object.defineProperty(this,"_totalLength",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const e=this.get("source");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isDirty("target")){const e=this.get("target");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this.markDirty()})))}}if(this.isPrivateDirty("orientation")){const e=this.series,t=this.dataItem;t&&e&&e._updateLinkColor(t)}const e=this.get("target"),t=this.get("source");let i,n;if(t&&e){this._clear=!0,i=t.get("node"),n=e.get("node");let s=0,a=0,r=0,o=0,l=0,c=0,u=0,h=0,d=0,g=0,f=0,p=0,b=0,y=0,m=0,_=0,k=0,w=0;const v=this.dataItem;if(v){const x=v.get("d3SankeyLink");if(x){let v=x.width||0,P=this.getPrivate("orientation");"vertical"==P?(i&&(r=i.y()+i.get("dy",0)),n&&(o=n.y()+n.get("dy",0)),k=90,w=90,s=x.y0||0,a=x.y1||0,s+=i.get("dx",0),a+=n.get("dx",0),o<r&&([s,a]=[a,s],[r,o]=[o,r]),t.get("unknown")&&(s=a,r+=(o-r)/2),e.get("unknown")&&(a=s,o=r+(o-r)/2),l=s-v/2,c=r,u=a-v/2,h=o,d=s+v/2,g=a+v/2,f=r,p=o,b=s,y=a,m=r,_=o):(i&&(s=i.x()+i.get("dx",0)),n&&(a=n.x()+n.get("dx",0)),r=x.y0||0,o=x.y1||0,r+=i.get("dy",0),o+=n.get("dy",0),a<s&&([s,a]=[a,s],[r,o]=[o,r]),t.get("unknown")&&(r=o,s+=(a-s)/2),e.get("unknown")&&(o=r,a=s+(a-s)/2),l=s,c=r-v/2,u=a,h=o-v/2,d=s,g=a,f=r+v/2,p=o+v/2,b=s,y=a,m=r,_=o),te.LI(l,3)==te.LI(u,3)&&(u+=.01),te.LI(c,3)==te.LI(h,3)&&(h+=.01),te.LI(d,3)==te.LI(g,3)&&(g+=.01),te.LI(f,3)==te.LI(p,3)&&(p+=.01);let D=this.get("controlPointDistance",.2);D=Math.min(.4999,D);let A=l+(u-l)*D*te.gn(k),N=c+(h-c)*D*te.F8(k),L=u-(u-l)*D*te.gn(w),j=h-(h-c)*D*te.F8(w),O=b+(y-b)*D*te.gn(k),I=m+(_-m)*D*te.F8(k),T=y-(y-b)*D*te.gn(w),R=_-(_-m)*D*te.F8(w),S=te._H({x:A,y:N},{x:L,y:j}),C=(v/te.gn(S)-v)/te.Ml(S)*te.gn(k),M=(v/te.F8(S)-v)*te.Ml(S)*te.F8(k),F=-C/2+d+(g-d)*D*te.gn(k),G=-M/2+f+(p-f)*D*te.F8(k),B=-C/2+g-(g-d)*D*te.gn(w),E=-M/2+p-(p-f)*D*te.F8(w);A+=C/2,N+=M/2,L+=C/2,j+=M/2,"vertical"==P?(N=Math.min(h,Math.max(c+1,N)),G=Math.min(p,Math.max(f+1,G)),j=Math.max(c,Math.min(h-1,j)),E=Math.max(f,Math.min(p-1,E))):(A=Math.min(u,Math.max(l+1,A)),F=Math.min(g,Math.max(d+1,F)),L=Math.max(l,Math.min(u-1,L)),B=Math.max(d,Math.min(g-1,B)));let W=[[l,c,d,f],[A,N,F,G],[L,j,B,E],[u,h,g,p]];this.set("draw",(e=>{const t=this.series;t._fillGenerator.context(e),t._fillGenerator(W)}));let H=[[b,m],[O,I],[T,R],[y,_]];const z=this.series._strokeGenerator(H);z&&(this._svgPath.setAttribute("d",z),this._totalLength=this._svgPath.getTotalLength())}}}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem)}getPoint(e){if(this._svgPath&&this._svgPath.getAttribute("d")){let t=this._svgPath.getPointAtLength(e*this._totalLength-.1),i=this._svgPath.getPointAtLength(e*this._totalLength+.1),n=this.toGlobal(this._svgPath.getPointAtLength(e*this._totalLength));return{x:n.x,y:n.y,angle:te._H(t,i)}}return{x:0,y:0,angle:0}}_getTooltipPoint(){return this.toLocal(super._getTooltipPoint())}}Object.defineProperty(ge,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SankeyLink"}),Object.defineProperty(ge,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([ge.className])});var fe=i(1872),pe=i(8907),be=i(824),ye=i(8657);function me(e,t){let i=0;if(void 0===t)for(let n of e)(n=+n)&&(i+=n);else{let n=-1;for(let s of e)(s=+t(s,++n,e))&&(i+=s)}return i}function _e(e,t){let i;if(void 0===t)for(const n of e)null!=n&&(i<n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let s of e)null!=(s=t(s,++n,e))&&(i<s||void 0===i&&s>=s)&&(i=s)}return i}function ke(e,t){let i;if(void 0===t)for(const n of e)null!=n&&(i>n||void 0===i&&n>=n)&&(i=n);else{let n=-1;for(let s of e)null!=(s=t(s,++n,e))&&(i>s||void 0===i&&s>=s)&&(i=s)}return i}function we(e){return e.target.depth}function ve(e){return e.depth}function xe(e,t){return t-1-e.height}function Pe(e,t){return e.sourceLinks.length?e.depth:t-1}function De(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?ke(e.sourceLinks,we)-1:0}function Ae(e){return function(){return e}}function Ne(e,t){return je(e.source,t.source)||e.index-t.index}function Le(e,t){return je(e.target,t.target)||e.index-t.index}function je(e,t){return e.y0-t.y0}function Oe(e){return e.value}function Ie(e){return e.index}function Te(e){return e.nodes}function Re(e){return e.links}function Se(e,t){const i=e.get(t);if(!i)throw new Error("missing: "+t);return i}function Ce(e){let{nodes:t}=e;for(const i of t){let e=i.y0,t=e;for(const n of i.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(const n of i.targetLinks)n.y1=t+n.width/2,t+=n.width}}function Me(){let e,t,i,n=0,s=0,a=1,r=1,o=24,l=8,c=Ie,u=Pe,h=Te,d=Re,g=6;function f(){const f={nodes:h.apply(null,arguments),links:d.apply(null,arguments)};return function(e){let{nodes:t,links:n}=e;for(const[i,a]of t.entries())a.index=i,a.sourceLinks=[],a.targetLinks=[];const s=new Map(t.map(((e,i)=>[c(e,i,t),e])));for(const[i,a]of n.entries()){a.index=i;let{source:e,target:t}=a;"object"!==typeof e&&(e=a.source=Se(s,e)),"object"!==typeof t&&(t=a.target=Se(s,t)),e.sourceLinks.push(a),t.targetLinks.push(a)}if(null!=i)for(const{sourceLinks:a,targetLinks:r}of t)a.sort(i),r.sort(i)}(f),function(e){let{nodes:t}=e;for(const i of t)i.value=void 0===i.fixedValue?Math.max(me(i.sourceLinks,Oe),me(i.targetLinks,Oe)):i.fixedValue}(f),function(e){let{nodes:t}=e;const i=t.length;let n=new Set(t),s=new Set,a=0;for(;n.size;){for(const e of n){e.depth=a;for(const{target:t}of e.sourceLinks)s.add(t)}if(++a>i)throw new Error("circular link");n=s,s=new Set}}(f),function(e){let{nodes:t}=e;const i=t.length;let n=new Set(t),s=new Set,a=0;for(;n.size;){for(const e of n){e.height=a;for(const{source:t}of e.targetLinks)s.add(t)}if(++a>i)throw new Error("circular link");n=s,s=new Set}}(f),function(i){const c=function(e){let{nodes:i}=e;const s=_e(i,(e=>e.depth))+1,r=(a-n-o)/(s-1),l=new Array(s);for(const t of i){const e=Math.max(0,Math.min(s-1,Math.floor(u.call(null,t,s))));t.layer=e,t.x0=n+e*r,t.x1=t.x0+o,l[e]?l[e].push(t):l[e]=[t]}if(t)for(const n of l)n.sort(t);return l}(i);e=Math.min(l,(r-s)/(_e(c,(e=>e.length))-1)),function(t){const i=ke(t,(t=>(r-s-(t.length-1)*e)/me(t,Oe)));for(const n of t){let t=s;for(const s of n){s.y0=t,s.y1=t+s.value*i,t=s.y1+e;for(const e of s.sourceLinks)e.width=e.value*i}t=(r-t+e)/(n.length+1);for(let e=0;e<n.length;++e){const i=n[e];i.y0+=t*(e+1),i.y1+=t*(e+1)}w(n)}}(c);for(let e=0;e<g;++e){const t=Math.pow(.99,e),i=Math.max(1-t,(e+1)/g);b(c,t,i),p(c,t,i)}}(f),Ce(f),f}function p(e,i,n){for(let s=1,a=e.length;s<a;++s){const a=e[s];for(const e of a){let t=0,n=0;for(const{source:i,value:a}of e.targetLinks){let s=a*(e.layer-i.layer);t+=v(i,e)*s,n+=s}if(!(n>0))continue;let s=(t/n-e.y0)*i;e.y0+=s,e.y1+=s,k(e)}void 0===t&&a.sort(je),y(a,n)}}function b(e,i,n){for(let s=e.length-2;s>=0;--s){const a=e[s];for(const e of a){let t=0,n=0;for(const{target:i,value:a}of e.sourceLinks){let s=a*(i.layer-e.layer);t+=x(e,i)*s,n+=s}if(!(n>0))continue;let s=(t/n-e.y0)*i;e.y0+=s,e.y1+=s,k(e)}void 0===t&&a.sort(je),y(a,n)}}function y(t,i){const n=t.length>>1,a=t[n];_(t,a.y0-e,n-1,i),m(t,a.y1+e,n+1,i),_(t,r,t.length-1,i),m(t,s,0,i)}function m(t,i,n,s){for(;n<t.length;++n){const a=t[n],r=(i-a.y0)*s;r>1e-6&&(a.y0+=r,a.y1+=r),i=a.y1+e}}function _(t,i,n,s){for(;n>=0;--n){const a=t[n],r=(a.y1-i)*s;r>1e-6&&(a.y0-=r,a.y1-=r),i=a.y0-e}}function k(e){let{sourceLinks:t,targetLinks:n}=e;if(void 0===i){for(const{source:{sourceLinks:e}}of n)e.sort(Le);for(const{target:{targetLinks:e}}of t)e.sort(Ne)}}function w(e){if(void 0===i)for(const{sourceLinks:t,targetLinks:i}of e)t.sort(Le),i.sort(Ne)}function v(t,i){let n=t.y0-(t.sourceLinks.length-1)*e/2;for(const{target:s,width:a}of t.sourceLinks){if(s===i)break;n+=a+e}for(const{source:e,width:s}of i.targetLinks){if(e===t)break;n-=s}return n}function x(t,i){let n=i.y0-(i.targetLinks.length-1)*e/2;for(const{source:s,width:a}of i.targetLinks){if(s===t)break;n+=a+e}for(const{target:e,width:s}of t.sourceLinks){if(e===i)break;n-=s}return n}return f.update=function(e){return Ce(e),e},f.nodeId=function(e){return arguments.length?(c="function"===typeof e?e:Ae(e),f):c},f.nodeAlign=function(e){return arguments.length?(u="function"===typeof e?e:Ae(e),f):u},f.nodeSort=function(e){return arguments.length?(t=e,f):t},f.nodeWidth=function(e){return arguments.length?(o=+e,f):o},f.nodePadding=function(t){return arguments.length?(l=e=+t,f):l},f.nodes=function(e){return arguments.length?(h="function"===typeof e?e:Ae(e),f):h},f.links=function(e){return arguments.length?(d="function"===typeof e?e:Ae(e),f):d},f.linkSort=function(e){return arguments.length?(i=e,f):i},f.size=function(e){return arguments.length?(n=s=0,a=+e[0],r=+e[1],f):[a-n,r-s]},f.extent=function(e){return arguments.length?(n=+e[0][0],a=+e[1][0],s=+e[0][1],r=+e[1][1],f):[[n,s],[a,r]]},f.iterations=function(e){return arguments.length?(g=+e,f):g},f}class Fe extends p{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>ge._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(de.new(this._root,{}))}),Object.defineProperty(this,"_d3Sankey",{enumerable:!0,configurable:!0,writable:!0,value:Me()}),Object.defineProperty(this,"_d3Graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,fe.A)()}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:(0,pe.A)()})}_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["sankey",this._settings.orientation||"horizontal"]),this._fillGenerator.y0((function(e){return e[3]})),this._fillGenerator.x0((function(e){return e[2]})),this._fillGenerator.y1((function(e){return e[1]})),this._fillGenerator.x1((function(e){return e[0]})),super._afterNew()}makeLink(e){const t=e.get("source"),i=e.get("target"),n=this.links.make();return t.get("unknown")&&(n.addTag("source"),n.addTag("unknown")),i.get("unknown")&&(n.addTag("target"),n.addTag("unknown")),this.linksContainer.children.push(n),n._setDataItem(e),n.set("source",t),n.set("target",i),n.series=this,this.links.push(n),n}updateSankey(){const e=this._d3Graph;e&&(this._d3Sankey.update(e),l.__(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()})))}_updateLinkColor(e){super._updateLinkColor(e);const t=this.get("orientation"),i=e.get("link")._fillGradient,n=e.get("link")._strokeGradient;"vertical"==t?(i&&i.set("rotation",90),n&&n.set("rotation",90)):(i&&i.set("rotation",0),n&&n.set("rotation",0))}_getBulletLocation(e){return"vertical"==this.get("orientation")?e.get("locationY",0):e.get("locationX",0)}_prepareChildren(){super._prepareChildren();let e=!1;if("vertical"==this.get("orientation")&&(e=!0),this.isDirty("orientation")||this.isDirty("linkTension")){const t=this.get("linkTension",.5);e?(this._fillGenerator.curve((0,ye.w)(t)),this._strokeGenerator.curve((0,ye.w)(t))):(this._fillGenerator.curve((0,be.D)(t)),this._strokeGenerator.curve((0,be.D)(t)))}if((this._valuesDirty||this._sizeDirty||this.isDirty("nodePadding")||this.isDirty("nodeWidth")||this.isDirty("nodeAlign")||this.isDirty("nodeSort")||this.isDirty("orientation")||this.isDirty("linkTension")||this.isDirty("linkSort"))&&this._nodesData.length>0){const t=this._d3Sankey;let i=this.innerWidth(),n=this.innerHeight();switch(e&&([i,n]=[n,i]),t.size([i,n]),t.nodePadding(this.get("nodePadding",10)),t.nodeWidth(this.get("nodeWidth",10)),t.nodeSort(this.get("nodeSort",null)),t.linkSort(this.get("linkSort")),this.get("nodeAlign")){case"right":t.nodeAlign(xe);break;case"justify":t.nodeAlign(Pe);break;case"center":t.nodeAlign(De);break;default:t.nodeAlign(ve)}this._d3Graph=t({nodes:this._nodesData,links:this._linksData}),l.__(this.dataItems,(e=>{const t=e.get("link");t.setPrivate("orientation",this.get("orientation")),t.markDirty()}));const s=this._d3Graph;if(s){const t=s.nodes;l.__(t,(t=>{const i=t.dataItem,n=i.get("node");let s,a,r,o;if(e?(s=t.y0,a=t.y1,r=t.x0,o=t.x1):(s=t.x0,a=t.x1,r=t.y0,o=t.y1),f.Et(s)&&f.Et(a)&&f.Et(r)&&f.Et(o)){n.setAll({x:s,y:r,width:a-s,height:o-r});i.get("rectangle").setAll({width:a-s,height:o-r})}}))}}}}Object.defineProperty(Fe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Sankey"}),Object.defineProperty(Fe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:p.classNames.concat([Fe.className])});var Ge=i(9025);class Be extends Z{constructor(){super(...arguments),Object.defineProperty(this,"labels",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>q.J._new(this._root,{},[this.labels.template])))}),Object.defineProperty(this,"flow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dAngle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"circles",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>Ge.j._new(this._root,{themeTags:["shape"]},[this.circles.template])))})}makeNode(e){const t=super.makeNode(e,"ArcDiagram"),i=t.children.insertIndex(0,this.circles.make());e.set("circle",i),i._setSoft("fill",e.get("fill")),i._setSoft("fillPattern",e.get("fillPattern"));const n=this.labels.make();return this.labels.push(n),n.addTag("flow"),n.addTag("arcdiagram"),n.addTag("node"),t.children.push(n),e.set("label",n),n._setDataItem(e),i._setDataItem(e),t}disposeDataItem(e){super.disposeDataItem(e);let t=e.get("circle");t&&(this.circles.removeValue(t),t.dispose())}_updateNodeColor(e){const t=e.get("circle");t&&(t.set("fill",e.get("fill")),t.set("fillPattern",e.get("fillPattern")))}}Object.defineProperty(Be,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagramNodes"}),Object.defineProperty(Be,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([Be.className])});class Ee extends se{constructor(){super(...arguments),Object.defineProperty(this,"_p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_radius",{enumerable:!0,configurable:!0,writable:!0,value:0})}_beforeChanged(){if(super._beforeChanged(),this.isDirty("source")){const e=this.get("source");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("stroke")})))}}if(this.isDirty("target")){const e=this.get("target");if(e){const t=e.get("node");this._disposers.push(t.events.on("positionchanged",(()=>{this._markDirtyKey("stroke")})))}}if(this.isPrivateDirty("orientation")){const e=this.series,t=this.dataItem;t&&e&&e._updateLinkColor(t)}this.series&&this.dataItem&&this.series._positionBullets(this.dataItem),"gradient"==this.get("strokeStyle")?this.set("isMeasured",!0):this.set("isMeasured",!1)}_changed(){super._changed(),this._clear&&this._draw()}_draw(){const e=this.get("target"),t=this.get("source");if(t&&e){let i=t.get("node"),n=e.get("node");const s=i.x(),a=i.y(),r=n.x(),o=n.y();this._p0={x:s,y:a},this._p1={x:r,y:o};let l=0;if("vertical"==this.getPrivate("orientation")){l=(o-a)/2;let e=1;a>o&&(e=-1),this._display.arc(s,a+l,l*e,-Math.PI/2,Math.PI/2)}else{l=(r-s)/2;let e=1;s>r&&(e=-1),this._display.arc(s+l,a,l*e,-Math.PI,0)}this._radius=l}}getPoint(e){if(this._p0&&this._p1){const t=this._radius;if("vertical"==this.getPrivate("orientation")){let i=180*e-90;return{y:this._p0.y+t+t*te.F8(i),x:t*te.gn(i),angle:i+90}}{let i=180+180*e;return{x:this._p0.x+t+t*te.gn(i),y:t*te.F8(i),angle:i+90}}}return{x:0,y:0,angle:0}}}Object.defineProperty(Ee,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagramLink"}),Object.defineProperty(Ee,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:se.classNames.concat([Ee.className])});class We extends p{constructor(){super(...arguments),Object.defineProperty(this,"links",{enumerable:!0,configurable:!0,writable:!0,value:new K.TS(J.Bj.new({}),(()=>Ee._new(this._root,{themeTags:["link","shape"]},[this.links.template])))}),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(Be.new(this._root,{}))})}_afterNew(){this._settings.themeTags=re.kE(this._settings.themeTags,["arcdiagram",this._settings.orientation||"horizontal"]),super._afterNew(),this.nodes.children.push(this.bulletsContainer)}makeLink(e){const t=this.nodes.children.moveValue(this.links.make(),0);return this.links.push(t),t._setDataItem(e),t.set("source",e.get("source")),t.set("target",e.get("target")),t.series=this,t}_prepareChildren(){if(super._prepareChildren(),this._valuesDirty||this._sizeDirty||this.isDirty("orientation")){let e=1;const t=this.get("orientation");l.__(this.dataItems,(e=>{e.get("link").setPrivate("orientation",this.get("orientation"))})),e="vertical"==t?this.innerHeight():this.innerWidth();let i=0,n=1/0,s=this.get("radiusKey");"none"!=s&&l.__(this.nodes.dataItems,(e=>{let t=e.get(s+"Working");i+=t,n=Math.min(n,t)}));const a=this.nodes.dataItems.length,r=this.get("nodePadding",10),o=this.get("minRadius",5);e-=a*(r+2*o),e<=0&&(e=0);let c=e/(i-a*n),u=0;const h=this.get("animationDuration",0),d=this.get("animationEasing");l.__(this.nodes.dataItems,(i=>{let l=i.get(s+"Working");const g=i.get("node");let f=o+c*(l-n)/2;if("none"==s&&(f=o+e/a/2),"vertical"==t){g.set("x",0);const e=u+r+f;0==g.y()?g.set("y",e):g.animate({key:"y",to:e,duration:h,easing:d})}else{g.set("y",0);const e=u+r+f;0==g.x()?g.set("x",e):g.animate({key:"x",to:e,duration:h,easing:d})}u=u+r+2*f,i.get("circle").set("radius",f)}))}}_updateLinkColor(e){super._updateLinkColor(e);const t=this.get("orientation"),i=e.get("link")._fillGradient,n=e.get("link")._strokeGradient;"vertical"==t?(i&&i.set("rotation",90),n&&n.set("rotation",90)):(i&&i.set("rotation",0),n&&n.set("rotation",0))}}Object.defineProperty(We,"className",{enumerable:!0,configurable:!0,writable:!0,value:"ArcDiagram"}),Object.defineProperty(We,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:p.classNames.concat([We.className])})},9927:(e,t,i)=>{i.d(t,{A:()=>x});var n=i(3809);const s=Math.abs,a=Math.atan2,r=Math.cos,o=Math.max,l=Math.min,c=Math.sin,u=Math.sqrt,h=1e-12,d=Math.PI,g=d/2,f=2*d;function p(e){return e>=1?g:e<=-1?-g:Math.asin(e)}var b=i(1286);function y(e){return e.innerRadius}function m(e){return e.outerRadius}function _(e){return e.startAngle}function k(e){return e.endAngle}function w(e){return e&&e.padAngle}function v(e,t,i,n,s,a,r){var l=e-i,c=t-n,h=(r?a:-a)/u(l*l+c*c),d=h*c,g=-h*l,f=e+d,p=t+g,b=i+d,y=n+g,m=(f+b)/2,_=(p+y)/2,k=b-f,w=y-p,v=k*k+w*w,x=s-a,P=f*y-b*p,D=(w<0?-1:1)*u(o(0,x*x*v-P*P)),A=(P*w-k*D)/v,N=(-P*k-w*D)/v,L=(P*w+k*D)/v,j=(-P*k+w*D)/v,O=A-m,I=N-_,T=L-m,R=j-_;return O*O+I*I>T*T+R*R&&(A=L,N=j),{cx:A,cy:N,x01:-d,y01:-g,x11:A*(s/x-1),y11:N*(s/x-1)}}function x(){var e=y,t=m,i=(0,n.A)(0),o=null,x=_,P=k,D=w,A=null,N=(0,b.i)(L);function L(){var n,b,y,m=+e.apply(this,arguments),_=+t.apply(this,arguments),k=x.apply(this,arguments)-g,w=P.apply(this,arguments)-g,L=s(w-k),j=w>k;if(A||(A=n=N()),_<m&&(b=_,_=m,m=b),_>h)if(L>f-h)A.moveTo(_*r(k),_*c(k)),A.arc(0,0,_,k,w,!j),m>h&&(A.moveTo(m*r(w),m*c(w)),A.arc(0,0,m,w,k,j));else{var O,I,T=k,R=w,S=k,C=w,M=L,F=L,G=D.apply(this,arguments)/2,B=G>h&&(o?+o.apply(this,arguments):u(m*m+_*_)),E=l(s(_-m)/2,+i.apply(this,arguments)),W=E,H=E;if(B>h){var z=p(B/m*c(G)),Y=p(B/_*c(G));(M-=2*z)>h?(S+=z*=j?1:-1,C-=z):(M=0,S=C=(k+w)/2),(F-=2*Y)>h?(T+=Y*=j?1:-1,R-=Y):(F=0,T=R=(k+w)/2)}var Q=_*r(T),V=_*c(T),X=m*r(C),J=m*c(C);if(E>h){var K,q=_*r(R),U=_*c(R),Z=m*r(S),$=m*c(S);if(L<d)if(K=function(e,t,i,n,s,a,r,o){var l=i-e,c=n-t,u=r-s,d=o-a,g=d*l-u*c;if(!(g*g<h))return[e+(g=(u*(t-a)-d*(e-s))/g)*l,t+g*c]}(Q,V,Z,$,q,U,X,J)){var ee=Q-K[0],te=V-K[1],ie=q-K[0],ne=U-K[1],se=1/c(((y=(ee*ie+te*ne)/(u(ee*ee+te*te)*u(ie*ie+ne*ne)))>1?0:y<-1?d:Math.acos(y))/2),ae=u(K[0]*K[0]+K[1]*K[1]);W=l(E,(m-ae)/(se-1)),H=l(E,(_-ae)/(se+1))}else W=H=0}F>h?H>h?(O=v(Z,$,Q,V,_,H,j),I=v(q,U,X,J,_,H,j),A.moveTo(O.cx+O.x01,O.cy+O.y01),H<E?A.arc(O.cx,O.cy,H,a(O.y01,O.x01),a(I.y01,I.x01),!j):(A.arc(O.cx,O.cy,H,a(O.y01,O.x01),a(O.y11,O.x11),!j),A.arc(0,0,_,a(O.cy+O.y11,O.cx+O.x11),a(I.cy+I.y11,I.cx+I.x11),!j),A.arc(I.cx,I.cy,H,a(I.y11,I.x11),a(I.y01,I.x01),!j))):(A.moveTo(Q,V),A.arc(0,0,_,T,R,!j)):A.moveTo(Q,V),m>h&&M>h?W>h?(O=v(X,J,q,U,m,-W,j),I=v(Q,V,Z,$,m,-W,j),A.lineTo(O.cx+O.x01,O.cy+O.y01),W<E?A.arc(O.cx,O.cy,W,a(O.y01,O.x01),a(I.y01,I.x01),!j):(A.arc(O.cx,O.cy,W,a(O.y01,O.x01),a(O.y11,O.x11),!j),A.arc(0,0,m,a(O.cy+O.y11,O.cx+O.x11),a(I.cy+I.y11,I.cx+I.x11),j),A.arc(I.cx,I.cy,W,a(I.y11,I.x11),a(I.y01,I.x01),!j))):A.arc(0,0,m,C,S,j):A.lineTo(X,J)}else A.moveTo(0,0);if(A.closePath(),n)return A=null,n+""||null}return L.centroid=function(){var i=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,n=(+x.apply(this,arguments)+ +P.apply(this,arguments))/2-d/2;return[r(n)*i,c(n)*i]},L.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:(0,n.A)(+t),L):e},L.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:(0,n.A)(+e),L):t},L.cornerRadius=function(e){return arguments.length?(i="function"===typeof e?e:(0,n.A)(+e),L):i},L.padRadius=function(e){return arguments.length?(o=null==e?null:"function"===typeof e?e:(0,n.A)(+e),L):o},L.startAngle=function(e){return arguments.length?(x="function"===typeof e?e:(0,n.A)(+e),L):x},L.endAngle=function(e){return arguments.length?(P="function"===typeof e?e:(0,n.A)(+e),L):P},L.padAngle=function(e){return arguments.length?(D="function"===typeof e?e:(0,n.A)(+e),L):D},L.context=function(e){return arguments.length?(A=null==e?null:e,L):A},L}}}]);
//# sourceMappingURL=json_flow.3fc0a5ec.chunk.js.map